<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Browse Products</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        background-color: #f9f9f9;
        font-family: "Segoe UI", sans-serif;
      }
      .filter-box {
        background: #ffffff;
        border-radius: 12px;
        padding: 25px;
        box-shadow: 0 0 12px rgba(0, 0, 0, 0.05);
      }
      .product-card {
        transition: 0.3s;
        border: none;
        border-radius: 1rem;
      }
      .product-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
      }
      .product-img {
        height: 180px;
        object-fit: contain;
        border-bottom: 1px solid #eee;
      }
      .tag-badge {
        font-size: 0.75rem;
        margin-right: 5px;
        background-color: #e1ecf4;
        color: #0366d6;
        border-radius: 10px;
        padding: 4px 10px;
      }
    </style>
  </head>
  <body>
    <%- include("./pages/navbar") %> <%- include("./pages/flashes") %>

    <div class="container-fluid py-5">
      <div class="row g-4">
        <!-- Sidebar Filter -->
        <div class="col-lg-3">
          <div class="filter-box">
            <h5 class="text-center mb-4">Filter Products</h5>
            <form method="get" action="/products/search">
              <!-- Sizes -->
              <div class="mb-3">
                <label class="form-label">Sizes</label>
                <div class="d-flex flex-wrap gap-2">
                  <% ["S", "M", "L", "XL", "XXL"].forEach(size => { %>
                  <input
                    type="checkbox"
                    class="btn-check"
                    name="size"
                    value="<%= size %>"
                    id="size_<%= size %>"
                  />
                  <label
                    class="btn btn-outline-dark btn-sm"
                    for="size_<%= size %>"
                    ><%= size %></label
                  >
                  <% }) %>
                </div>
              </div>

              <!-- Colors -->
              <div class="mb-3">
                <label class="form-label">Colors</label>
                <div class="d-flex flex-wrap gap-2">
                  <% ["Red", "Green", "Yellow", "Blue", "Black",
                  "White"].forEach(color => { %>
                  <input
                    type="checkbox"
                    class="btn-check"
                    name="color"
                    value="<%= color %>"
                    id="color_<%= color %>"
                  />
                  <label
                    class="btn btn-outline-secondary btn-sm"
                    for="color_<%= color %>"
                    ><%= color %></label
                  >
                  <% }) %>
                </div>
              </div>

              <!-- Price -->
              <div class="mb-3">
                <label class="form-label">Price Range</label>
                <input
                  type="number"
                  class="form-control mb-2"
                  name="minPrice"
                  placeholder="Min Price"
                />
                <input
                  type="number"
                  class="form-control"
                  name="maxPrice"
                  placeholder="Max Price"
                />
              </div>

              <!-- Brands -->
              <div class="mb-3">
                <label class="form-label">Brands</label>
                <% const brandList = productData.filter(p => p.brand).map(p =>
                p.brand); const uniqueBrand = [...new Set(brandList)]; %> <%
                uniqueBrand.forEach(brand => { %>
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    name="brand"
                    value="<%= brand %>"
                    id="brand_<%= brand %>"
                  />
                  <label class="form-check-label" for="brand_<%= brand %>"
                    ><%= brand %></label
                  >
                </div>
                <% }) %>
              </div>

              <div class="d-grid">
                <button type="submit" class="btn btn-primary mt-3">
                  Apply Filters
                </button>
              </div>
            </form>
          </div>
        </div>

        <!-- Products Grid -->
        <div class="col-lg-9">
          <% const visibleProducts = productData.filter(product =>
          product.isDeleted === true); %> <% if (visibleProducts.length === 0) {
          %>
          <h5 class="text-center text-muted">No products found.</h5>
          <% } else { %>
          <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-4">
            <% visibleProducts.forEach(product => { %>
            <div class="col">
              <div class="card product-card h-100 bg-white">
                <img
                  src="<%= product.image[0] %>"
                  class="card-img-top product-img p-3"
                  alt="<%= product.productName %>"
                />
                <div
                  class="card-body d-flex flex-column justify-content-between"
                >
                  <div>
                    <h6 class="card-title fw-bold text-primary">
                      <%= product.productName %>
                    </h6>
                    <p class="text-muted small"><%= product.productDesc %></p>
                    <div class="mb-2">
                      <span class="tag-badge"><%= product.brand %></span>
                      <span class="tag-badge"><%= product.color %></span>
                      <span class="tag-badge"><%= product.size %></span>
                    </div>
                  </div>
                  <div
                    class="d-flex justify-content-between align-items-center mt-2"
                  >
                    <span class="fw-bold text-success"
                      >$<%= product.price %></span
                    >
                    <a
                      href="/products/specific/<%= product._id %>"
                      class="btn btn-sm btn-outline-primary rounded-pill"
                      >Details</a
                    >
                  </div>
                </div>
              </div>
            </div>
            <% }) %>
          </div>
          <% } %>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
